{"version":3,"file":"stringify.cjs","sources":["../src/stringify.ts"],"sourcesContent":["export function stringify(\n  obj: any,\n  options?: {\n    indent?: number\n    maxDepth?: number\n    showUndefined?: boolean\n    showNull?: boolean\n    leadingComma?: boolean\n  }\n) {\n  const opt = Object.assign(\n    {\n      indent: \"  \",\n      maxDepth: 4,\n      showUndefined: false,\n      showNull: true,\n      leadingComma: false,\n    },\n    {\n      ...options,\n      indent: options?.indent !== undefined ? \" \".repeat(options.indent) : \"  \",\n    }\n  )\n  const seen = new WeakSet()\n  let msg: string = \"\"\n  let depth = 0\n  let runner = (key: string, value: any) => {\n    let keyLabel = key === \"\" ? \"\" : `${key}: `\n    let indent = `${opt.indent.repeat(depth)}`\n    let prefix = `${indent}${keyLabel}`\n    if (value === undefined) {\n      if (opt.showUndefined) {\n        msg += `${prefix}undefined`\n        return true\n      }\n      return false\n    }\n    if (value === null) {\n      if (opt.showNull) {\n        msg += `${prefix}null`\n        return true\n      }\n      return false\n    }\n    if (value instanceof Date) {\n      msg += `${prefix}\"[Date: ${value.toISOString()}]\"`\n      return true\n    }\n    if (typeof value === \"number\") {\n      msg += `${prefix}${value}`\n      return true\n    }\n    if (typeof value === \"string\") {\n      msg += `${prefix}\"${value}\"`\n      return true\n    }\n    if (value instanceof RegExp) {\n      msg += `${prefix}\"[RegExp: ${value.toString()}]\"`\n      return true\n    }\n    if (typeof value === \"object\") {\n      // NOTE: value === \"object\" includes Array!\n      if (seen.has(value)) {\n        msg += `${prefix}\"[circular ref]\"`\n        return true\n      }\n      seen.add(value)\n      depth++\n      if (Array.isArray(value)) {\n        msg += `${prefix}[\\n`\n        for (let i = 0; i < value.length; i++) {\n          const added = runner(\"\", value[i])\n          if (!added) continue\n          if (opt.leadingComma || i < value.length - 1) msg += \",\"\n          msg += \"\\n\"\n        }\n        msg += `${indent}]`\n      } else {\n        if (opt.maxDepth && depth > opt.maxDepth) {\n          msg += `${prefix}[max depth]`\n          depth--\n          return true\n        }\n        msg += `${prefix}{\\n`\n        let entries = Object.entries(value)\n        for (let i = 0; i < entries.length; i++) {\n          let [key, child] = entries[i]\n          const added = runner(key, child)\n          if (!added) continue\n          if (opt.leadingComma || i < entries.length - 1) msg += \",\"\n          msg += \"\\n\"\n        }\n        msg += `${indent}}`\n      }\n      depth--\n      return true\n    }\n    msg += `${prefix}${value}`\n    return true\n  }\n  runner(\"\", obj)\n  return msg\n}\n"],"names":["obj","options","opt","Object","assign","indent","maxDepth","showUndefined","showNull","leadingComma","_extends","undefined","repeat","seen","WeakSet","msg","depth","runner","key","value","keyLabel","prefix","Date","toISOString","RegExp","toString","has","add","Array","isArray","i","length","entries","_entries$_i"],"mappings":"sPAAgB,SACdA,EACAC,GAQA,IAAMC,EAAMC,OAAOC,OACjB,CACEC,OAAQ,KACRC,SAAU,EACVC,eAAe,EACfC,UAAU,EACVC,cAAc,GACfC,EAEIT,CAAAA,EAAAA,EACHI,CAAAA,YAA4BM,KAAb,MAAPV,OAAO,EAAPA,EAASI,QAAuB,IAAIO,OAAOX,EAAQI,QAAU,QAGnEQ,EAAO,IAAIC,QACbC,EAAc,GACdC,EAAQ,EA4EZ,OA3Ea,SAATC,EAAUC,EAAaC,GACzB,IAAIC,EAAmB,KAARF,EAAa,GAAQA,EAAG,KACnCb,EAAYH,GAAAA,EAAIG,OAAOO,OAAOI,GAC9BK,EAAM,GAAMhB,EAASe,EACzB,QAAcT,IAAVQ,EACF,QAAIjB,EAAIK,gBACNQ,GAAUM,EAAM,aAEjB,GAGH,GAAc,OAAVF,EACF,QAAIjB,EAAIM,WACNO,GAAUM,EAAY,QACf,GAIX,GAAIF,aAAiBG,KAEnB,OADAP,GAAUM,EAAiBF,WAAAA,EAAMI,cAAiB,MAC3C,EAET,GAAqB,iBAAVJ,EAET,OADAJ,GAAUM,GAAAA,EAASF,GAEpB,EACD,GAAqB,iBAAVA,EAET,OADAJ,GAAUM,EAAM,IAAIF,EAAK,KAE1B,EACD,GAAIA,aAAiBK,OAEnB,OADAT,GAAUM,EAAmBF,aAAAA,EAAMM,WAAc,MAC1C,EAET,GAAqB,iBAAVN,EAAoB,CAE7B,GAAIN,EAAKa,IAAIP,GAEX,OADAJ,GAAUM,EAAM,oBAEjB,EAGD,GAFAR,EAAKc,IAAIR,GACTH,IACIY,MAAMC,QAAQV,GAAQ,CACxBJ,GAAUM,EAAW,MACrB,IAAK,IAAIS,EAAI,EAAGA,EAAIX,EAAMY,OAAQD,IAClBb,EAAO,GAAIE,EAAMW,OAE3B5B,EAAIO,cAAgBqB,EAAIX,EAAMY,OAAS,KAAGhB,GAAO,KACrDA,GAAO,MAETA,GAAUV,EACX,GAAA,KAAM,CACL,GAAIH,EAAII,UAAYU,EAAQd,EAAII,SAG9B,OAFAS,GAAUM,EAAM,cAChBL,KACO,EAETD,GAAUM,EAAW,MAErB,IADA,IAAIW,EAAU7B,OAAO6B,QAAQb,GACpBW,EAAI,EAAGA,EAAIE,EAAQD,OAAQD,IAAK,CACvC,IAAAG,EAAmBD,EAAQF,GACbb,EADNgB,EAAA,GAAOA,EAAA,OAGX/B,EAAIO,cAAgBqB,EAAIE,EAAQD,OAAS,KAAGhB,GAAO,KACvDA,GAAO,KACR,CACDA,GAAUV,EACX,GAAA,CAED,OADAW,KAED,CAAA,CAED,OADAD,GAAG,GAAOM,EAASF,GACZ,CACT,CACAF,CAAO,GAAIjB,GACJe,CACT"}