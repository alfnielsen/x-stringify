{"version":3,"file":"stringify.cjs","sources":["../src/stringify.ts"],"sourcesContent":["export function stringify(\n  obj: any,\n  options?: {\n    indent?: number\n    maxDepth?: number\n    showUndefined?: boolean\n    showNull?: boolean\n    leadingComma?: boolean\n    removeKeys?: string[]\n  }\n) {\n  const opt = Object.assign(\n    {\n      indent: \"  \",\n      maxDepth: 4,\n      showUndefined: false,\n      showNull: true,\n      leadingComma: false,\n    },\n    {\n      ...options,\n      indent: options?.indent !== undefined ? \" \".repeat(options.indent) : \"  \",\n    }\n  )\n  const seen = new WeakSet()\n  let msg: string = \"\"\n  let depth = 0\n  let runner = (key: string, value: any) => {\n    if (opt.removeKeys && opt.removeKeys.includes(key)) return false\n    let keyLabel = key === \"\" ? \"\" : `${key}: `\n    let indent = `${opt.indent.repeat(depth)}`\n    let prefix = `${indent}${keyLabel}`\n    if (value === undefined) {\n      if (opt.showUndefined) {\n        msg += `${prefix}undefined`\n        return true\n      }\n      return false\n    }\n    if (value === null) {\n      if (opt.showNull) {\n        msg += `${prefix}null`\n        return true\n      }\n      return false\n    }\n    if (value instanceof Date) {\n      msg += `${prefix}\"[Date: ${value.toISOString()}]\"`\n      return true\n    }\n    if (typeof value === \"symbol\") {\n      msg += `${prefix}\"[Symbol: ${value.toString()}]\"`\n      return true\n    }\n    if (typeof value === \"number\") {\n      msg += `${prefix}${value}`\n      return true\n    }\n    if (typeof value === \"string\") {\n      msg += `${prefix}\"${value}\"`\n      return true\n    }\n    if (value instanceof RegExp) {\n      msg += `${prefix}\"[RegExp: ${value.toString()}]\"`\n      return true\n    }\n    if (typeof value === \"object\") {\n      // NOTE: value === \"object\" includes Array!\n      if (seen.has(value)) {\n        msg += `${prefix}\"[circular ref]\"`\n        return true\n      }\n      seen.add(value)\n      depth++\n      if (Array.isArray(value)) {\n        msg += `${prefix}[\\n`\n        for (let i = 0; i < value.length; i++) {\n          const added = runner(\"\", value[i])\n          if (!added) continue\n          if (opt.leadingComma || i < value.length - 1) msg += \",\"\n          msg += \"\\n\"\n        }\n        msg += `${indent}]`\n      } else {\n        if (opt.maxDepth && depth > opt.maxDepth) {\n          msg += `${prefix}[max depth]`\n          depth--\n          return true\n        }\n        msg += `${prefix}{\\n`\n        let entries = Object.entries(value)\n        for (let i = 0; i < entries.length; i++) {\n          let [key, child] = entries[i]\n          const added = runner(key, child)\n          if (!added) continue\n          if (opt.leadingComma || i < entries.length - 1) msg += \",\"\n          msg += \"\\n\"\n        }\n        msg += `${indent}}`\n      }\n      depth--\n      return true\n    }\n    msg += `${prefix}${value}`\n    return true\n  }\n  runner(\"\", obj)\n  return msg\n}\n"],"names":["obj","options","opt","Object","assign","indent","maxDepth","showUndefined","showNull","leadingComma","_extends","undefined","repeat","seen","WeakSet","msg","depth","runner","key","value","removeKeys","includes","keyLabel","prefix","Date","toISOString","toString","RegExp","has","add","Array","isArray","i","length","entries","_entries$_i","child"],"mappings":"sPAAgB,SACdA,EACAC,GASA,IAAMC,EAAMC,OAAOC,OACjB,CACEC,OAAQ,KACRC,SAAU,EACVC,eAAe,EACfC,UAAU,EACVC,cAAc,GACfC,EAEIT,CAAAA,EAAAA,EACHI,CAAAA,YAA4BM,KAApBV,MAAAA,OAAAA,EAAAA,EAASI,QAAuB,IAAIO,OAAOX,EAAQI,QAAU,QAGnEQ,EAAO,IAAIC,QACbC,EAAc,GACdC,EAAQ,EAiFZ,OAhFa,SAATC,EAAUC,EAAaC,GACzB,GAAIjB,EAAIkB,YAAclB,EAAIkB,WAAWC,SAASH,GAAM,SACpD,IAAII,EAAmB,KAARJ,EAAa,GAAQA,EAAG,KACnCb,KAAYH,EAAIG,OAAOO,OAAOI,GAC9BO,EAAYlB,GAAAA,EAASiB,EACzB,QAAcX,IAAVQ,EACF,QAAIjB,EAAIK,gBACNQ,GAAUQ,EAAM,aACT,GAIX,GAAc,OAAVJ,EACF,QAAIjB,EAAIM,WACNO,GAAUQ,EAAY,QACf,GAIX,GAAIJ,aAAiBK,KAEnB,OADAT,GAAUQ,EAAiBJ,WAAAA,EAAMM,cAAiB,MAC3C,EAET,GAAqB,iBAAVN,EAET,OADAJ,GAAUQ,EAAM,aAAaJ,EAAMO,WAAU,MACtC,EAET,GAAqB,iBAAVP,EAET,OADAJ,GAAUQ,GAAAA,EAASJ,GACZ,EAET,GAAqB,iBAAVA,EAET,OADAJ,GAAUQ,EAAM,IAAIJ,EAAK,KAClB,EAET,GAAIA,aAAiBQ,OAEnB,OADAZ,GAAUQ,EAAM,aAAaJ,EAAMO,WAAc,MAC1C,EAET,GAAqB,iBAAVP,EAAoB,CAE7B,GAAIN,EAAKe,IAAIT,GAEX,OADAJ,GAAUQ,EAAwB,oBAC3B,EAIT,GAFAV,EAAKgB,IAAIV,GACTH,IACIc,MAAMC,QAAQZ,GAAQ,CACxBJ,GAAUQ,EAAW,MACrB,IAAK,IAAIS,EAAI,EAAGA,EAAIb,EAAMc,OAAQD,IAClBf,EAAO,GAAIE,EAAMa,OAE3B9B,EAAIO,cAAgBuB,EAAIb,EAAMc,OAAS,KAAGlB,GAAO,KACrDA,GAAO,MAETA,GAAUV,EACX,GAAA,KAAM,CACL,GAAIH,EAAII,UAAYU,EAAQd,EAAII,SAG9B,OAFAS,GAAUQ,EAAmB,cAC7BP,KACO,EAETD,GAAUQ,EAAW,MAErB,IADA,IAAIW,EAAU/B,OAAO+B,QAAQf,GACpBa,EAAI,EAAGA,EAAIE,EAAQD,OAAQD,IAAK,CACvC,IAAAG,EAAmBD,EAAQF,GACbf,EADNkB,EAAEC,GAAKD,EAAA,OAGXjC,EAAIO,cAAgBuB,EAAIE,EAAQD,OAAS,KAAGlB,GAAO,KACvDA,GAAO,KACR,CACDA,GAAUV,EACX,GAAA,CAED,OADAW,KAED,CAAA,CAED,OADAD,GAAUQ,GAAAA,EAASJ,GAErB,CAAA,CACAF,CAAO,GAAIjB,GACJe,CACT"}